<% page_title('Dashboard') %>

<a id="logout_link" rel="nofollow" data-method="delete" href="<%= destroy_user_session_url(:protocol => "#{Rails.env.production? ? 'https://' : 'http://'}") %>">Logout</a>

<%= form_for(current_user, as: current_user.id, url: submit_url_user_path(current_user.id),
             html: {class: 'form-horizontal', id: 'submit_url', method: :post}) do |f| %>

    <%= content_tag :div, class: 'panel-body' do %>
        <%= content_tag :p, 'Enter the URL to your publication page to get started', style: 'margin-top:-20px;' %>
    <% end %>

    <%= content_tag :div, class: 'input-group', style: 'margin-top:0px' do %>
        <%= content_tag :span, content_tag(:i, '', class: 'fa fa-external-link'), class: 'input-group-addon' %>
        <%= f.url_field :url, placeholder: 'URL', autofocus: true, class: 'form-control' %>
    <% end %>

    <%= content_tag :div, class: 'form-actions clearfix' do %>
       <%= f.submit 'Submit URL', :class => 'btn btn-block btn-paircon' %>
    <% end %>
<% end %>

<button id="getResult">Get Result or machine learning</button>

<script>
  $('#getResult').click(function() {
      var data = {
          user_dir: '<%= "#{Rails.root}/public/conference_papers" %>',
          conference_dir: '<%= "#{Rails.root}/public/conference_papers" %>',
          k: 3
      };

      $.ajax({
          type: 'POST',
          url: '<%= "#{PairConConfig.recommendation_system_domain}/similiarity/v1/compare" %>',
          data: JSON.stringify(data),
          dataType: "json",
          contentType: "application/json",
          success: function (text, status, xhr) {
              showNotificationMsg(text);
          },
          error: function (xhr, status, text) {
              showErrorMsg(xhr.responseText);
          }

      });
  });
</script>